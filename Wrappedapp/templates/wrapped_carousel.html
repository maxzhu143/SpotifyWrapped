{% extends "base.html" %}
{% load django_bootstrap5 %}

{% block title %}Spotify Wrapped{% endblock %}

{% block content %}
<div class="container-fluid p-0" style="height: 100vh; width: 100vw;">
    <!-- Carousel -->
    <div id="spotifyWrappedCarousel" class="carousel slide" data-bs-ride="carousel" style="height: 100%; width: 100%;">
        <div class="carousel-inner" style="height: 100%; width: 100%;">

            <!-- Slide 1: Welcome -->
            <div class="carousel-item active animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="welcome-title text-animate-fade">Welcome to Your Spotify Wrapped</h1>
                    <h2 class="welcome-name text-animate-slide">{{ wrapped.user }}'s 2024 Music Journey</h2>
                    <p class="welcome-subtext text-animate-zoom">Dive into your personalized music stats!</p>
                </div>
            </div>

            <!-- Slide 2: Total Listening Time -->
            <div class="carousel-item animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="listening-title text-animate-fade">Total Listening Time</h1>
                    <p class="listening-subtext text-animate-hover">
                        You spent <span class="highlight">{{ wrapped.total_minutes_listened }}</span> minutes listening this year!
                    </p>
                </div>
            </div>


            <!-- Slide 3: Your Top Artists -->
            <div class="carousel-item animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="artists-title text-animate-zoom">Your Top Artists</h1>
                    <div class="artist-list">
                        {% for artist in wrapped.top_artists %}
                        <div class="artist-item">
                            {% if artist.image_url %}
                            <img src="{{ artist.image_url }}" alt="{{ artist.name }}'s image" class="artist-image">
                            {% else %}
                            <div class="artist-image" style="background-color: gray;"></div>
                            {% endif %}
                            <div class="artist-details">
                                <div class="artist-name">{{ artist.name }}</div>
                                {% if artist.genres %}
                                <div class="artist-genres">Genres: {{ artist.genres }}</div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>


            <!-- Slide 4: Music Trends -->
            <div class="carousel-item animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="trends-title text-animate-slide">Music Trends</h1>
                    <p class="trends-subtext text-animate-fade">You listened to <span class="highlight">more Pop</span> and <span class="highlight">Hip-Hop</span> than ever before!</p>
                </div>
            </div>

            <!-- Slide 5: Listening Personality -->
            <div class="carousel-item animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="personality-title text-animate-slide">
                        Your Listening Personality
                    </h1>
                    <h2 class="personality-highlight text-animate-zoom">
                        You are <span class="highlight">{{ wrapped.personality_word }}</span> listener!
                    </h2>
                    <p class="personality-description text-animate-fade">
                        This {{ wrapped.personality }}
                    </p>
                    <p class="personality-subtext text-animate-hover">
                        Discover how your music habits define your unique listening traits.
                    </p>
                </div>
            </div>

            <!-- Slide: Your Top Songs -->
            <div class="carousel-item animated-background">
                <div class="dynamic-shapes">
                    <div class="circle large"></div>
                    <div class="circle medium"></div>
                    <div class="circle small"></div>
                    <div class="circle tiny"></div>
                    <div class="flower"></div>
                    <div class="flower small"></div>
                    <div class="star floating"></div>
                    <div class="star shooting"></div>
                    <div class="star shooting alternate"></div>
                </div>
                <div class="d-flex flex-column align-items-center justify-content-center text-container" style="height: 100%;">
                    <h1 class="title text-animate-fade">Your Top Songs</h1>
                    <div class="top-songs-container">
                        {% for song in top_songs %}
                        <div class="top-song-item">
                            <img src="{{ song.cover }}" alt="Album cover for {{ song.name }}" class="album-cover">
                            <div class="song-details">
                                <h3 class="song-title">{{ song.name }}</h3>
                                <p class="artist-name">By: {{ song.artist }}</p>
                                <p class="album-name">Album: {{ song.album }}</p>
                                <a href="{{ song.spotify_url }}" target="_blank" class="spotify-link">Play on Spotify</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>


        <!-- Carousel Controls -->
        <button class="carousel-control-prev static-arrow" type="button" data-bs-target="#spotifyWrappedCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon no-hover" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next static-arrow" type="button" data-bs-target="#spotifyWrappedCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon no-hover" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
        </div>
    </div>
</div>



<style>
    /* Text Animations */
    .text-animate-fade {
        animation: fadeIn 2s ease-in-out;
    }
    @keyframes fadeIn {
        0% { opacity: 0; }
        100% { opacity: 1; }
    }

    .text-animate-slide {
        animation: slideIn 2s ease-in-out;
    }
    @keyframes slideIn {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(0); }
    }

    .text-animate-zoom {
        animation: zoomIn 2s ease-in-out;
    }
    @keyframes zoomIn {
        0% { transform: scale(0.5); opacity: 0; }
        100% { transform: scale(1); opacity: 1; }
    }

    .text-animate-hover:hover {
        transform: scale(1.1);
        transition: transform 0.3s ease-in-out;
    }
    @keyframes colorShift {
        0% { background: linear-gradient(45deg, #1DB954, #191414); }
        25% { background: linear-gradient(45deg, #FF007F, #590FB7); }
        50% { background: linear-gradient(45deg, #FFC312, #EE5A24); }
        75% { background: linear-gradient(45deg, #16A085, #27AE60); }
        100% { background: linear-gradient(45deg, #1DB954, #191414); }
    }

    .animated-background {
        animation: colorShift 12s infinite;
        background-size: 300% 300%;
        height: 100%;
    }

    /* Dynamic Shapes */
    .dynamic-shapes {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: 0;
    }

    .circle {
        position: absolute;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        animation: float 10s infinite ease-in-out;
    }

    .circle.small { width: 100px; height: 100px; top: 25%; left: 15%; }
    .circle.medium { width: 150px; height: 150px; top: 50%; left: 50%; }
    .circle.large { width: 200px; height: 200px; top: 10%; left: 60%; }
    .circle.tiny { width: 80px; height: 80px; top: 75%; left: 80%; }

    .flower {
        position: absolute;
        width: 120px;
        height: 120px;
        background: radial-gradient(circle, #16A085, #27AE60);
        clip-path: polygon(50% 0%, 61% 35%, 100% 35%, 68% 57%, 80% 91%, 50% 70%, 21% 91%, 32% 57%, 0 35%, 39% 35%);
        top: 70%;
        left: 20%;
        animation: float 12s infinite ease-in-out;
    }

    .flower.small { width: 80px; height: 80px; top: 40%; left: 75%; }

    .star {
        position: absolute;
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #FF007F, #FFC312);
        clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
    }

    .star.floating {
        animation: float 8s infinite ease-in-out;
        top: 20%;
        left: 10%;
    }

    .star.shooting {
        animation: shootDiagonal 8s infinite linear;
        top: 10%;
        left: -20%;
    }

    .star.shooting.alternate {
        animation: shootDiagonalAlternate 10s infinite linear;
        top: 30%;
        left: -30%;
    }

    @keyframes shootDiagonal {
        0% { transform: translate(0, 0); }
        100% { transform: translate(120vw, 100vh); }
    }

    @keyframes shootDiagonalAlternate {
        0% { transform: translate(0, 0); }
        100% { transform: translate(120vw, -100vh); }
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-20px); }
    }

    /* Arrows */
    .static-arrow {
        width: 50px;
        height: 50px;
        top: 50%;
        transform: translateY(-50%);
    }

    .carousel-control-prev-icon,
    .carousel-control-next-icon {
        background-color: rgba(0, 0, 0, 0.5);
        border-radius: 50%;
        width: 50px;
        height: 50px;
    }

    .no-hover {
        transition: none !important;
    }

    /* Text Styling */
    .text-container {
        position: relative;
        z-index: 1;
        color: white;
        text-align: center;
    }

    .welcome-title,
    .listening-title,
    .artists-title,
    .trends-title {
        font-family: 'Arial Black', sans-serif;
        font-size: 3rem;
        margin-bottom: 0.5rem;
    }

    .welcome-name {
        font-size: 2rem;
        font-family: 'Arial', sans-serif;
        margin-bottom: 1rem;
    }

    .welcome-subtext,
    .listening-subtext,
    .trends-subtext {
        font-size: 1.25rem;
        font-family: 'Arial', sans-serif;
    }

    .artists-list li {
        font-size: 1.5rem;
        line-height: 2rem;
    }

    .highlight {
        color: #FFC312;
        font-weight: bold;
    }

    /* Artist list container */
    .artist-list {
        display: flex;                  /* Use flexbox for layout */
        flex-wrap: wrap;                /* Wrap items to the next row if needed */
        justify-content: center;        /* Center items horizontally */
        gap: 20px;                      /* Space between artist items */
        max-width: 90%;                 /* Restrict the width of the entire list */
        padding: 20px;                  /* Add padding around the list */
    }

    /* Individual artist items */
    .artist-item {
        display: flex;                  /* Flex layout for image and details */
        flex-direction: column;         /* Stack image and text vertically */
        align-items: center;            /* Center-align text and image */
        background-color: #282828;      /* Dark Spotify-like background */
        border-radius: 10px;            /* Rounded corners */
        padding: 10px;                  /* Add padding inside each item */
        width: 150px;                   /* Limit the width of each item */
        text-align: center;             /* Center-align text */
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
    }

    /* Artist image */
    .artist-image {
        border-radius: 50%;             /* Circular image */
        width: 100px;                   /* Fixed width */
        height: 100px;                  /* Fixed height */
        object-fit: cover;              /* Crop and fit the image */
        margin-bottom: 10px;            /* Space between image and details */
    }

    /* Artist details */
    .artist-details .artist-name {
        font-size: 16px;                /* Adjust font size */
        font-weight: bold;              /* Bold text for names */
        color: white;                   /* White text for better contrast */
        margin-bottom: 5px;             /* Space between name and genres */
    }

    .artist-details .artist-genres {
        font-size: 14px;                /* Smaller font for genres */
        color: #a3a3a3;                 /* Lighter color for genres */
    }

    /* Responsive adjustments for smaller screens */
    @media (max-width: 768px) {
        .artist-item {
            width: 120px;               /* Reduce item size for smaller screens */
        }

        .artist-image {
            width: 80px;                /* Adjust image size for smaller screens */
            height: 80px;
        }

        .artist-details .artist-name {
            font-size: 14px;            /* Adjust font size */
        }

        .artist-details .artist-genres {
            font-size: 12px;            /* Adjust font size */
        }
    }

        /* Personality Slide Title */
    .personality-title {
        font-family: 'Arial Black', sans-serif;
        font-size: 3rem;
        margin-bottom: 1rem;
        color: #fff;
    }

    /* Highlight Style */
    .personality-highlight {
        font-family: 'Arial Black', sans-serif;
        font-size: 2.5rem;
        color: #FFC312; /* Highlight in gold */
        margin-bottom: 1rem;
    }

    /* Description Text */
    .personality-description {
        font-family: 'Arial', sans-serif;
        font-size: 1.25rem;
        color: white;
        max-width: 80%; /* Limit the width to 80% of the container */
        margin: 0 auto; /* Center-align the text */
        text-align: center; /* Ensure text is center-aligned */
        line-height: 1.6; /* Add line spacing for better readability */
        padding: 10px; /* Add padding for spacing */
        background: rgba(0, 0, 0, 0.5); /* Add a subtle background for contrast */
        border-radius: 10px; /* Rounded corners for a polished look */
    }

    /* Subtext Styling */
    .personality-subtext {
        font-family: 'Arial', sans-serif;
        font-size: 1rem;
        color: #a3a3a3;
        text-align: center;
        margin-top: 1rem;
    }

    /* Adjust Responsiveness */
    @media (max-width: 768px) {
        .personality-title {
            font-size: 2rem; /* Reduce font size on smaller screens */
        }

        .personality-highlight {
            font-size: 1.8rem;
        }

        .personality-description {
            font-size: 1rem; /* Smaller font for mobile */
            max-width: 90%; /* Adjust width for smaller screens */
        }

        .personality-subtext {
            font-size: 0.9rem;
        }
    }
    /* Top Songs Slide */
    /* Top Songs Slide */
    .top-songs-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        max-width: 90%;
        padding: 20px;
    }

    .top-song-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 10px;
        padding: 15px;
        width: 200px;
        text-align: center;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
    }

    .album-cover {
        width: 100%;
        border-radius: 5px;
        margin-bottom: 10px;
    }

    .song-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 5px 0;
        color: white;
    }

    .artist-name, .album-name {
        font-size: 1rem;
        margin: 5px 0;
        color: #FFC312;
    }

    .spotify-link {
        margin-top: 10px;
        color: #1DB954;
        text-decoration: none;
        font-weight: bold;
    }

    .spotify-link:hover {
        text-decoration: underline;
    }



</style>
{% endblock %}